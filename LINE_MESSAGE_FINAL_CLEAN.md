# LINE 通知訊息 - 最終簡潔版

## 📱 最終訊息結構

### 商家完整版

```
┌─────────────────────────────────────┐
│  ┌────────────────────────────┐    │
│  │    [Banner 圖片 3:1]       │    │  ← Hero（唯一的 Banner）
│  └────────────────────────────┘    │
├─────────────────────────────────────┤
│  小明的手環 已經過 守護合作商家     │
│  星巴克信義店                       │
│  ───────────────────                │
│  設備：小明的手環                   │
│  地點：星巴克信義店                 │
│  時間：2026/01/29 14:30            │
├─────────────────────────────────────┤
│  ┌──────────────────────────┐      │
│  │        查看地圖          │      │  ← 青綠色主按鈕
│  └──────────────────────────┘      │
│  ───────────────────                │
│  商家優惠                           │
│                                     │  (Banner 已移除)
│  春節特惠活動                       │
│                                     │
│  全店商品 8 折優惠...              │
│                                     │
│  ┌──────────────────────────┐      │
│  │      店家資訊            │      │  ← 白底灰框次按鈕
│  └──────────────────────────┘      │
│  此通知由您設定的通知點自動發送     │
└─────────────────────────────────────┘
```

## 🔄 修改說明

### 移除的內容

```typescript
// 已移除：商家優惠區塊中的 Banner 圖片
...(data.imageLink ? [
  {
    type: "image",
    url: data.imageLink,
    aspectRatio: "3:1",
    ...
  }
] : [])
```

### 保留的 Banner

- ✅ Hero 區域的 Banner（3:1）
- ❌ 商家優惠區塊的 Banner（已移除）

### 原因

- Hero 已經有 Banner 了
- 不需要重複顯示
- 避免訊息過長
- 更簡潔清爽

## 📊 區塊結構

### Hero（條件）

- **內容**：Banner 圖片 (3:1)
- **條件**：`isAD && imageLink`
- **用途**：視覺吸引

### Body（必須）

1. 通知主旨
   - 商家：「已經過 守護合作商家」
   - 一般：「已經過」
2. 地點名稱（location）
3. 分隔線
4. 詳細資訊（設備、地點、時間）

### Footer（操作區）

1. 查看地圖按鈕（主按鈕）
2. 商家優惠區塊（條件）
   - 分隔線
   - 「商家優惠」標題
   - 優惠標題
   - 優惠內容
   - 店家資訊按鈕
3. 底部提示

## 🎯 簡化優勢

### 1. 避免重複

- ❌ 之前：Hero 有 Banner + 商家優惠區塊也有 Banner
- ✅ 現在：只有 Hero 有 Banner

### 2. 訊息更短

- 減少視覺負擔
- 更容易閱讀
- 手機上顯示更友好

### 3. 重點突出

- Hero Banner：第一視覺焦點
- 商家優惠：文字重點（標題 + 內容）
- 不會因為太多圖片而分散注意力

## 📏 訊息長度對比

### 修改前（較長）

```
Hero: Banner
Body: 通知 + 詳細資訊
Footer:
  [查看地圖]
  商家優惠
    Banner  ← 第二次出現
    標題
    內容
    [店家資訊]
```

### 修改後（較短）✅

```
Hero: Banner
Body: 通知 + 詳細資訊
Footer:
  [查看地圖]
  商家優惠
    標題    ← 直接顯示文字
    內容
    [店家資訊]
```

## 🎨 視覺流程

```
用戶打開通知
  ↓
看到 Banner（Hero）     ← 唯一的 Banner
  ↓
閱讀「已經過 守護合作商家」
  ↓
看到店家名稱
  ↓
查看詳細資訊
  ↓
點擊 [查看地圖]
  ↓ 或
閱讀商家優惠（純文字）  ← 無重複 Banner
  ↓
點擊 [店家資訊]
```

## 📝 修改總結

### 最終的 LINE 訊息特色

1. ✅ **Hero Banner**：3:1 商家宣傳圖（唯一的圖片）
2. ✅ **守護合作商家**：商家專屬標記
3. ✅ **簡潔商家優惠**：純文字呈現（無重複 Banner）
4. ✅ **白底灰框按鈕**：店家資訊（專業風格）
5. ✅ **大間距**：舒適的閱讀體驗

## ✅ Build 狀態

- ✅ TypeScript 編譯通過
- ✅ Functions Build 成功

## 🚀 準備部署

```bash
cd functions
firebase deploy --only functions:receiveBeaconData
```

訊息結構簡化完成，更清爽易讀！🎉
