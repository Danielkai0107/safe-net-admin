# LIFF 地圖商家 Banner 比例更新

## 📐 更新內容

### Banner 圖片比例固定為 3:1

將商家優惠 Banner 圖片從「自動高度」改為「固定 3:1 比例」顯示。

## 🔄 修改前後對比

### 修改前

```jsx
<div
  style={{
    width: "100%",
    marginBottom: "12px",
    borderRadius: "8px",
    overflow: "hidden",
  }}
>
  <img
    src={selectedGateway.imageLink}
    style={{
      width: "100%",
      height: "auto", // ← 自動高度，不固定比例
      display: "block",
    }}
  />
</div>
```

**問題**：

- ❌ 圖片高度不固定，取決於原始圖片比例
- ❌ 不同商家的 Banner 高度可能差異很大
- ❌ 視覺不統一

### 修改後

```jsx
<div
  style={{
    position: "relative",
    width: "100%",
    paddingTop: "33.33%", // ← 3:1 比例
    marginBottom: "12px",
    borderRadius: "8px",
    overflow: "hidden",
    backgroundColor: "#f3f4f6",
  }}
>
  <img
    src={selectedGateway.imageLink}
    style={{
      position: "absolute",
      top: 0,
      left: 0,
      width: "100%",
      height: "100%",
      objectFit: "cover", // ← 裁切填滿
      display: "block",
    }}
  />
</div>
```

**優點**：

- ✅ 所有 Banner 統一 3:1 比例
- ✅ 視覺一致性更好
- ✅ 使用 `object-fit: cover` 自動裁切適配
- ✅ 添加灰色背景防止圖片加載失敗時留白

## 🎨 技術實現

### Padding-Top 技巧

使用 CSS 的 `padding-top` 百分比技巧來創建固定比例容器：

```
比例計算：
- 3:1 → height / width = 1/3 = 33.33%
- paddingTop: "33.33%" → 高度為寬度的 33.33%
```

### Object-Fit: Cover

```css
object-fit: cover;
```

- 圖片會填滿整個容器
- 保持圖片原始比例
- 超出部分會被裁切
- 確保不會變形

### 背景色

```css
backgroundcolor: "#f3f4f6";
```

- 圖片加載前/失敗時顯示淡灰色背景
- 提升用戶體驗

## 📱 視覺效果

### 情境 A：橫向圖片（原本就是 3:1 或更寬）

```
原圖：1200 x 400 (3:1)
顯示：完美填滿，無裁切
```

### 情境 B：正方形圖片（1:1）

```
原圖：400 x 400 (1:1)
顯示：上下裁切，只顯示中間 33.33% 高度部分
```

### 情境 C：直向圖片（1:2）

```
原圖：400 x 800 (1:2)
顯示：上下大幅裁切，只顯示中間部分
```

### 情境 D：超寬圖片（16:9）

```
原圖：1920 x 1080 (16:9)
顯示：左右裁切，上下填滿
```

## 🎯 建議圖片尺寸

### 最佳尺寸

- **推薦**：1200 x 400 像素（剛好 3:1）
- **最小**：900 x 300 像素
- **最大**：1800 x 600 像素

### 安全區域

如果圖片不是 3:1 比例，建議將重要內容放在中心區域，避免被裁切。

```
┌─────────────────────────────┐
│       可能被裁切區域        │
├─────────────────────────────┤
│                             │
│      安全區域（中心）       │  ← 重要內容放這裡
│                             │
├─────────────────────────────┤
│       可能被裁切區域        │
└─────────────────────────────┘
```

## 📊 與 Admin 管理後台的一致性

### Admin 商店管理

- **Logo 預覽**：1:1 比例（正方形）
- **Banner 預覽**：3:1 比例（橫向）
- **建議尺寸**：1200x400

### LIFF 地圖顯示

- **Logo 顯示**：32x32 圓形（1:1）
- **Banner 顯示**：3:1 比例（橫向）✅ **已統一**

## ⚠️ 注意事項

### 1. 圖片裁切

- 使用 `object-fit: cover` 時，圖片可能會被裁切
- 上傳前建議先調整為 3:1 比例
- 或確保重要內容在中心區域

### 2. 圖片大小

- 建議壓縮圖片以提升載入速度
- 推薦使用 WebP 格式（更小的檔案大小）
- 檔案大小建議 < 500KB

### 3. 響應式

- 3:1 比例在不同螢幕寬度下都能保持
- 手機上的顯示效果良好
- 圖片會自動縮放

## 🔍 測試建議

### 測試案例

1. ✅ 測試 3:1 比例圖片（完美匹配）
2. ✅ 測試正方形圖片（會裁切）
3. ✅ 測試直向圖片（大幅裁切）
4. ✅ 測試超寬圖片（左右裁切）
5. ✅ 測試圖片加載失敗（顯示灰色背景）
6. ✅ 測試沒有圖片的情況（不顯示）

### 瀏覽器測試

- [ ] Chrome (Desktop)
- [ ] Safari (Desktop)
- [ ] Chrome (Mobile)
- [ ] Safari (iOS)
- [ ] LINE 內建瀏覽器

## 📝 相關文件更新

1. ✅ `liff/src/screens/map/MapScreen.tsx` - 修改 Banner 顯示邏輯
2. ✅ `LIFF_MAP_UPDATE_SUMMARY.md` - 更新文檔說明
3. ✅ `LIFF_BANNER_RATIO_UPDATE.md` - 新增此文檔

## 🎨 CSS 屬性詳解

### Container

```css
position: relative; /* 為絕對定位的圖片提供參考點 */
width: 100%; /* 填滿父容器寬度 */
paddingtop: 33.33%; /* 創建 3:1 比例的高度 */
borderradius: 8px; /* 圓角 */
overflow: hidden; /* 隱藏超出部分 */
backgroundcolor: #f3f4f6; /* 背景色 */
```

### Image

```css
position: absolute; /* 絕對定位，覆蓋整個容器 */
top: 0; /* 頂部對齊 */
left: 0; /* 左側對齊 */
width: 100%; /* 填滿寬度 */
height: 100%; /* 填滿高度 */
objectfit: cover; /* 保持比例，裁切超出部分 */
display: block; /* 移除圖片下方空白 */
```

## 🚀 部署檢查清單

- [✅] 代碼修改完成
- [✅] 無 TypeScript 錯誤
- [✅] 無 Linter 錯誤
- [⏳] 本地測試通過（待測試）
- [⏳] 不同圖片比例測試（待測試）
- [⏳] 手機端測試（待測試）
- [⏳] LINE 瀏覽器測試（待測試）

## 💡 未來優化建議

1. **圖片優化**
   - 自動壓縮上傳的圖片
   - 自動轉換為 WebP 格式
   - 生成多種尺寸（響應式）

2. **編輯工具**
   - 提供圖片裁切工具
   - 預覽 3:1 比例效果
   - 安全區域標示

3. **載入優化**
   - 圖片懶加載
   - 模糊預覽（Blur Hash）
   - 漸進式加載

4. **錯誤處理**
   - 圖片加載失敗時顯示預設圖片
   - 顯示「圖片載入中」動畫
   - 重試機制
