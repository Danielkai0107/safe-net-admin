# LINE 通知訊息 - 簡化版本

## 📋 最終結構

### 商家完整版

```
┌─────────────────────────────────────┐
│  ┌────────────────────────────┐    │
│  │    [Banner 圖片 3:1]       │    │  ← Hero: imageLink
│  └────────────────────────────┘    │
├─────────────────────────────────────┤
│                                     │
│  小明的手環 已經過                  │  ← Body: 通知主旨
│  星巴克信義店                       │     (特大、青綠色)
│                                     │
│  ───────────────────                │  ← Body: 分隔線
│                                     │
│  設備：小明的手環                   │  ← Body: 詳細資訊
│  地點：星巴克信義店                 │
│  時間：2026/01/29 14:30            │
│                                     │
├─────────────────────────────────────┤
│                                     │
│  ┌──────────────────────────┐      │
│  │        查看地圖          │      │  ← Footer: 主按鈕（青綠色）
│  └──────────────────────────┘      │
│                                     │
│  ───────────────────                │  ← Footer: 分隔線
│                                     │
│  商家優惠                           │  ← Footer: 商家優惠區塊
│                                     │
│  春節特惠活動                       │     (間距加大 lg)
│                                     │
│  全店商品 8 折優惠...              │
│                                     │
│  ┌──────────────────────────┐      │
│  │      店家資訊            │      │  ← Footer: 次按鈕（白底灰框）
│  └──────────────────────────┘      │
│                                     │
│  此通知由您設定的通知點自動發送     │
│                                     │
└─────────────────────────────────────┘
```

## 📊 區塊說明

### Hero（條件顯示）

- **內容**：3:1 Banner 圖片
- **條件**：`isAD && imageLink`
- **用途**：商家宣傳視覺

### Body（始終顯示）

1. **通知主旨**
   - 「{設備名稱} 已經過」
   - 「{地點名稱}」（location，特大青綠色）

2. **分隔線**

3. **詳細資訊**
   - 設備：{deviceName}
   - 地點：{gatewayName}
   - 時間：{timestamp}

### Footer（操作區）

1. **主按鈕：查看地圖**
   - 青綠色實心按鈕
   - 最重要的操作

2. **商家優惠區塊**（條件顯示）
   - 條件：`isAD && (activityTitle || websiteLink)`
   - 分隔線
   - 「商家優惠」標題
   - Banner 圖片（如有）
   - 優惠標題（如有）
   - 優惠內容（如有）
   - 店家資訊按鈕（如有 websiteLink）

3. **底部提示**
   - 說明文字

## 🎨 按鈕樣式

### 查看地圖（Primary）

```typescript
{
  style: "primary",
  color: "#4ECDC4"
}
```

**效果**：

```
┌─────────────────┐
│   查看地圖      │  ← 青綠色實心、白字
└─────────────────┘
```

### 店家資訊（Secondary）

```typescript
{
  style: "secondary";
  // 不設定 color
}
```

**效果**：

```
┌─────────────────┐
│   店家資訊      │  ← 白底、灰色邊框、深灰字 ✅
└─────────────────┘
```

## 📏 間距規範

### 商家優惠區塊

```typescript
{
  spacing: "lg",    // 區塊內元素間距（大）
  contents: [
    { margin: "none" },  // 商家優惠標題
    { margin: "lg" },    // Banner 圖片
    { margin: "lg" },    // 優惠標題
    { margin: "md" },    // 優惠內容
    { margin: "lg" },    // 店家資訊按鈕
  ]
}
```

## 🔄 與之前版本的對比

### Version 2（之前）

```
[查看地圖]
─────────
[Logo] 店名        ← 有這個區塊
─────────
商家優惠...
[店家資訊]
```

### Version 3（現在）✅

```
[查看地圖]
─────────
商家優惠...        ← Logo 區塊已移除
[店家資訊]
```

## ✨ 簡化優勢

### 1. 結構更簡潔

- ❌ 移除重複的店名顯示（Body 已經有了）
- ✅ 減少視覺干擾

### 2. 資訊不重複

```
Body 中已經有：「已經過 星巴克信義店」
不需要在 Footer 再顯示一次「[Logo] 星巴克信義店」
```

### 3. 焦點更集中

```
查看地圖
  ↓
商家優惠（直接進入重點）
  ↓
店家資訊
```

## 🎯 使用者流程

### 用戶視角

```
收到通知
  ↓
看到 Banner（如有）
  ↓
閱讀「已通過 星巴克信義店」
  ↓ (已經知道是哪家店了)
查看詳細資訊
  ↓
決策：
  1. [查看地圖] → 確認位置
  2. 看到商家優惠 → 了解活動
  3. [店家資訊] → 前往官網
```

**不需要**：

- ❌ 在 Footer 再次顯示 Logo 和店名
- ✅ Body 已經清楚說明是哪家店

## 📝 修改總結

### 移除的內容

```typescript
// 已移除：Logo + 店名區塊
...(isStore && data.storeLogo ? [
  { type: "separator" },
  {
    type: "box",
    layout: "horizontal",
    contents: [
      { type: "image", url: storeLogo },
      { type: "text", text: gatewayName }
    ]
  }
] : [])
```

### 保留的內容

- ✅ Hero: Banner 圖片
- ✅ Body: 通知主旨 + 詳細資訊
- ✅ Footer: 查看地圖按鈕
- ✅ Footer: 商家優惠區塊
- ✅ Footer: 店家資訊按鈕（白底灰框）

## 🎨 最終效果

### 完整商家訊息

```
[Banner 3:1]
已通過 星巴克信義店
─────────
設備、地點、時間
[查看地圖] 青綠色
─────────
商家優惠

春節特惠活動

全店商品 8 折優惠...

[店家資訊] 白底灰框
```

### 一般 Gateway

```
已通過 大安公園
─────────
設備、地點、時間
[查看地圖] 青綠色
```

## ✅ 檢查清單

- [✅] 移除 Logo + 店名區塊
- [✅] 保留 Banner Hero
- [✅] 保留通知主旨
- [✅] 保留商家優惠區塊
- [✅] 店家資訊按鈕：白底灰框
- [✅] 商家優惠間距：lg
- [✅] TypeScript 編譯通過
- [✅] Functions Build 成功

## 🚀 準備部署

```bash
cd functions
firebase deploy --only functions:receiveBeaconData
```

訊息結構簡化完成，更清晰易讀！🎉
